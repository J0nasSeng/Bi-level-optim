import numpy as np

pred_1 = np.array([[2.1893213, 2.1956048, 2.203274, 2.2147808, 2.2099612, 2.2109845,
                    2.2192383, 2.2173026, 2.2158346, 2.2223697, 2.2254465, 2.2310274,
                    2.2360742, 2.226638, 2.2236457, 2.2273378, 2.2260103, 2.2202368]],
                  dtype=np.float32)

test_y_val_1 = np.array([[2.21259613, 2.20385386, 2.20968204, 2.2147817, 2.21551022,
                          2.25958584, 2.2599501, 2.27670612, 2.22971641, 2.21041057,
                          2.24574391, 2.25011504, 2.21223187, 2.25667175, 2.23518033,
                          2.28034873, 2.31495355, 2.30803258]])

pred_10 = np.array([[1.6071362, 1.5989151, 1.5757527, 1.5668042, 1.5547389, 1.5214058,
                     1.5084288, 1.4892148, 1.4636762, 1.4714426, 1.4534081, 1.4294497,
                     1.4300054, 1.4108412, 1.380965, 1.3797047, 1.3750225, 1.3663077]],
                   dtype=np.float32)

test_y_val_10 = np.array([[1.50524742, 1.73376463, 1.97023026, 1.83047046, 1.78874123,
                           1.93379998, 1.7894036, 1.84106836, 2.13118586, 2.0921061,
                           1.85431573, 2.04574029, 2.2318659, 2.42858941, 2.55178999,
                           2.43587546, 2.37427517, 2.35837832]])

pred_100 = np.array([[-0.887941, -0.88338834, -0.8831244, -0.8818251, -0.8789858,
                      -0.87989557, -0.88266367, -0.8788088, -0.8761392, -0.87126964,
                      -0.86678433, -0.8678809, -0.86744887, -0.86641324, -0.8668904,
                      -0.87095565, -0.8680543, -0.8670201]], dtype=np.float32)

test_y_val_100 = np.array([[-0.88179141, -0.86836112, -0.8697981, -0.88568786, -0.86570822,
                            -0.85560786, -0.85135217, -0.84619836, -0.85285824, -0.85131072,
                            -0.84748336, -0.83942795, -0.83911015, -0.8309442, -0.8183153,
                            -0.80800768, -0.80998354, -0.81353455]])

pred_1000 = np.array([[3.2242296, 3.2397482, 3.2611964, 3.276244, 3.2770145, 3.2816274,
                       3.28342, 3.2812674, 3.2759924, 3.2470675, 3.2735176, 3.2861652,
                       3.3047686, 3.3091843, 3.3026688, 3.3079, 3.3006475, 3.300417]],
                     dtype=np.float32)

test_y_val_1000 = np.array([[3.52801455, 3.53991071, 3.65403457, 3.49010544, 3.40952875,
                             3.29627727, 3.3272073, 3.43800024, 3.5490311, 3.50263606,
                             3.51191507, 3.46369595, 3.38613297, 3.35718563, 3.2863638,
                             3.29207396, 3.48606074, 3.44378971]])


def smape(A, F):
    return 1 / len(A) * np.sum(np.abs(F - A) / (np.abs(A) + np.abs(F)))


A = pred_10[0, :]
F = test_y_val_10[0, :]

print(smape(A, F))
